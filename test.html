<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Yarım Kalan Hikayeler · TEST</title>
<style>
  :root{--bg:#0b1220;--card:#0f172a;--ink:#e5e7eb;--muted:#94a3b8;--line:#1f2937}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#0b1220;color:var(--ink)}
  header{padding:10px 14px;border-bottom:1px solid var(--line);background:#0f172a}
  .wrap{max-width:900px;margin:0 auto}
  .build{font-size:12px;color:#a7f3d0}
  .btn{appearance:none;border:1px solid var(--line);background:#111827;color:var(--ink);border-radius:10px;padding:8px 12px;cursor:pointer}
  main{padding:16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px}
  .muted{color:var(--muted)}
  .err{color:#fecaca;background:#7f1d1d;border:1px solid #ef4444;padding:8px 10px;border-radius:8px}
</style>

<!-- ALARM TESTİ: Bu script çalışıyorsa JS açıktır -->
<script>
  alert("JS ÇALIŞIYOR");
</script>
<noscript>
  <style>body{background:#111827;color:#fee2e2}</style>
  <div class="err" style="max-width:900px;margin:16px auto">
    Tarayıcınızda JavaScript kapalı görünüyor. Lütfen JS’i etkinleştirin.
  </div>
</noscript>
</head>
<body>
  <header>
    <div class="wrap" style="display:flex;gap:10px;align-items:center">
      <strong>Yarım Kalan Hikayeler</strong>
      <span class="build">BUILD v501 — alarm testi</span>
      <span style="flex:1"></span>
      <button class="btn" id="gotoLogin">Giriş</button>
      <button class="btn" id="gotoProfil">Profil</button>
      <button class="btn" id="clearSel">Seçileni temizle</button>
    </div>
  </header>

  <main class="wrap">
    <div id="status" class="muted" style="margin:12px 0">Yükleniyor…</div>

    <!-- LOGIN -->
    <section id="loginView" class="card" style="display:none">
      <h2 style="margin:0 0 10px">Giriş (Kullanıcı Seç)</h2>
      <select id="userSelect"></select>
      <button class="btn" id="enterBtn" style="margin-top:10px">Giriş Yap</button>
      <p class="muted" style="margin-top:10px">Seçim kaydedilir ve profil görüntülenir.</p>
    </section>

    <!-- PROFIL -->
    <section id="profilView" class="card" style="display:none">
      <h3>Profil</h3>
      <img id="photo" alt="Profil" style="width:100%;height:240px;object-fit:cover;border-radius:12px">
      <h2 id="name" style="margin:12px 0 6px">—</h2>
      <p id="ageBio" class="muted">—</p>
      <h3 style="margin-top:12px">Hakkında</h3>
      <p id="about" class="muted">—</p>
      <h3 style="margin-top:12px">Son karşılaşmalar</h3>
      <ul id="meets" class="muted" style="padding-left:18px;margin:0"><li>—</li></ul>
    </section>
  </main>

<script>
(function(){
  const statusEl = document.getElementById('status');
  try{
    statusEl.textContent = 'JS BOOT OK · ' + new Date().toLocaleTimeString();

    // Demo görseli (internet gerekmez)
    const IMG = 'data:image/svg+xml;utf8,'+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="900" height="600"><rect width="100%" height="100%" fill="#0ea5e9"/><text x="50%" y="55%" font-family="Arial" font-size="42" fill="#e5e7eb" text-anchor="middle">Profil Foto</text></svg>');
    const USERS = {
      ayse:{id:"ayse",ad:"Ayşe Y.",yas:27,bio:"08:30 · kitap & kahve", fotograf:IMG,
        hakkinda:"Sakin, güleryüzlü; klasik müzik, kısa yürüyüşler.",
        karsilasmalar:["Levent - 12 Ağu","Taksim - 14 Ağu","Şişli - 15 Ağu"]},
      mehmet:{id:"mehmet",ad:"Mehmet K.",yas:30,bio:"18:10 · bisiklet & satranç", fotograf:IMG,
        hakkinda:"Teknoloji meraklısı; hafta sonu orman turu.",
        karsilasmalar:["Gayrettepe - 10 Ağu","Osmanbey - 14 Ağu"]},
      elif:{id:"elif",ad:"Elif T.",yas:25,bio:"09:05 · klasik müzik & fotoğraf", fotograf:IMG,
        hakkinda:"Açık tenli, başörtülü; şehir içi kısa kaçamaklar.",
        karsilasmalar:["Yenikapı - 9 Ağu","Haliç - 13 Ağu","Şişli - 15 Ağu"]}
    };

    const $ = id => document.getElementById(id);
    function show(v){$('loginView').style.display = v==='login'?'block':'none';
                     $('profilView').style.display = v==='profil'?'block':'none';}

    // Login seçenekleri
    const sel = $('userSelect');
    Object.values(USERS).forEach(u=>{
      const opt=document.createElement('option'); opt.value=u.id; opt.textContent=${u.ad} (${u.yas}); sel.appendChild(opt);
    });
    const last = (localStorage.getItem('yklh_selectedUserId')||'ayse'); if(USERS[last]) sel.value=last;

    $('enterBtn').onclick = ()=>{
      const id = sel.value; localStorage.setItem('yklh_selectedUserId', id);
      loadProfil(); show('profil');
    };

    function loadProfil(){
      const id = (localStorage.getItem('yklh_selectedUserId')||'ayse');
      const u = USERS[id] || USERS['ayse'];
      $('photo').src = u.fotograf;
      $('name').textContent = u.ad;
      $('ageBio').textContent = ${u.yas} • ${u.bio};
      $('about').textContent = u.hakkinda;
      const m = $('meets'); m.innerHTML='';
      u.karsilasmalar.forEach(t=>{const li=document.createElement('li'); li.textContent=t; m.appendChild(li);});
      statusEl.textContent = `Yüklendi · kullanıcı: ${u.id} · ` + new Date().toLocaleTimeString();
    }

    $('gotoLogin').onclick = ()=>show('login');
    $('gotoProfil').onclick = ()=>{loadProfil(); show('profil');};
    $('clearSel').onclick = ()=>{localStorage.removeItem('yklh_selectedUserId'); alert('Seçim temizlendi.');};

    if(localStorage.getItem('yklh_selectedUserId')){ loadProfil(); show('profil'); }
    else{ show('login'); }

  }catch(err){
    statusEl.className = 'err';
    statusEl.textContent = 'Hata: ' + (err && err.message ? err.message : err);
  }
})();
</script>
</body>
</html>
