<!doctype html>
<meta charset="utf-8">
<title>Profil • YKH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#fafafa}
  header{display:flex;gap:8px;align-items:center;padding:12px 16px;border-bottom:1px solid #eee;background:#fff}
  header a{font-size:14px;color:#06f;text-decoration:none}
  .wrap{max-width:840px;margin:16px auto;padding:0 16px}
  .hero{aspect-ratio:16/9;background:#eee;border-radius:12px;overflow:hidden}
  .hero img{width:100%;height:100%;object-fit:cover;display:block}
  .name{font-size:26px;font-weight:700;margin:14px 0 4px}
  .tags{color:#666}
  .nav{margin-top:14px;display:flex;gap:8px}
  .btn{padding:10px 14px;border:1px solid #ddd;border-radius:10px;background:#fff;cursor:pointer}
  .err{margin:12px 16px;padding:10px;border:1px solid #f5c2c7;background:#f8d7da;color:#842029;border-radius:8px;display:none;white-space:pre-wrap}
</style>
<header>
  <a href="index.html">← Anasayfa</a>
</header>
<div class="err" id="err"></div>
<div class="wrap">
  <div class="hero"><img id="avatar" alt="Profil foto"></div>
  <div class="name" id="name">Yükleniyor…</div>
  <div class="tags" id="tags"></div>
  <div class="nav">
    <button class="btn" id="prev">⟵ Önceki</button>
    <button class="btn" id="next">Sonraki ⟶</button>
  </div>
</div>
<script>
const E = (id)=>document.getElementById(id);
const errBox = E("err");

function showError(msg){
  errBox.textContent = msg;
  errBox.style.display = "block";
  console.error(msg);
}

let users = [];
let curId = Number(new URLSearchParams(location.search).get("id")) || 1;

function show(id){
  const u = users.find(x => Number(x.id) === Number(id)) || users[0];
  if(!u){ showError("Kullanıcı bulunamadı."); return; }

  curId = u.id;

  // İsim & etiketler
  E("name").textContent = u.name || "(isimsiz)";
  E("tags").textContent = (u.tags || []).join(" • ");

  // Görsel
  const img = E("avatar");
  img.src = "assets/" + (u.photo || "");
  img.onerror = () => { showError("Görsel bulunamadı: " + img.src); };

  // URL'yi güncelle
  history.replaceState(null, "", "?id=" + encodeURIComponent(u.id));
}

fetch("data/users.json?v="+Date.now())
  .then(r => {
    if(!r.ok) throw new Error("users.json yüklenemedi: HTTP " + r.status);
    return r.json();
  })
  .then(list => {
    if(!Array.isArray(list)) throw new Error("users.json bir liste ([]) değil.");
    users = list;
    show(curId);

    // İleri/geri
    E("prev").onclick = ()=>{
      const i = users.findIndex(u=>Number(u.id)===Number(curId));
      const ni = (i-1+users.length) % users.length;
      show(users[ni].id);
    };
    E("next").onclick = ()=>{
      const i = users.findIndex(u=>Number(u.id)===Number(curId));
      const ni = (i+1) % users.length;
      show(users[ni].id);
    };
  })
  .catch(e => showError("Hata: " + e.message));
</script>
