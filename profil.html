<script>
  function getQueryId() {
    const m = location.search.match(/[?&]id=(\d+)/);
    return m ? m[1] : null;
  }

  function resolveSelectedId() {
    let id = localStorage.getItem('secili_kullanici_id');
    if (id) return id;
    id = getQueryId();
    if (id) {
      localStorage.setItem('secili_kullanici_id', String(id));
      return id;
    }
    return null;
  }

  async function init() {
    const app = document.getElementById('app');
    const id = resolveSelectedId();
    if (!id) {
      app.innerHTML = <div class="error">Seçili kullanıcı yok. <a href="login.html">Giriş yap</a></div>;
      return;
    }

    try {
      const res = await fetch('data/users.json');
      const users = await res.json();
      const user = users.find(u => u.id === Number(id));

      if (!user) {
        app.innerHTML = <div class="error">Kullanıcı bulunamadı. <a href="login.html">Giriş yap</a></div>;
        return;
      }

      // Profil render
      app.innerHTML = `
        <section class="card hero">
          <img src="${user.profilFoto}" alt="${user.ad}">
          <div class="bio">
            <h1>${user.ad}</h1>
            <div class="muted">${user.konum ?? ""}</div>
            <p>${user.bio ?? ""}</p>
            <button onclick="localStorage.removeItem('secili_kullanici_id'); location.href='login.html';">Çıkış Yap</button>
          </div>
        </section>
      `;
    } catch (err) {
      console.error('Profil yüklenemedi', err);
      app.innerHTML = <div class="error">Veri yüklenemedi. <a href="login.html">Geri dön</a></div>;
    }
  }

  init();
<script>
(async () => {
  const res = await fetch('data/users.json');
  const users = await res.json();
  console.log('profilde users verisi:', users);
})();
</script>
